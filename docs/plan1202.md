# Analysis: Sharpe vs Wealth - What's Really Happening

## Key Findings from Complete Data Analysis

### Correlation: -0.0288 (Weak Negative)
- **Not** a strong systematic inverse relationship
- Indicates Sharpe and Wealth measure **independent dimensions**

### Overlap: 2/5 Portfolios in Both Top-5 Lists
- Portfolios #4 and #13 excel in BOTH metrics
- This is actually **good** - it shows some portfolios achieve both

### The Real Pattern

**Group 1: High Sharpe, Moderate Wealth (Consistency Winners)**
- #7: Sharpe=1.01, Wealth=$1k, DD=3.2%
- #4: Sharpe=0.91, Wealth=$2k, DD=3.4%  
- #13: Sharpe=0.87, Wealth=$5k, DD=3.5%
- #11: Sharpe=0.79, Wealth=$182, DD=12.7%

**Group 2: Lower Sharpe, High Wealth (Home Run Winners)**
- #1: Sharpe=0.50, Wealth=$485k, DD=18.5%
- #8: Sharpe=0.50, Wealth=$238k, DD=17.2%
- #14: Sharpe=0.51, Wealth=$103k, DD=18.6%

**Group 3: Low Sharpe, Low Wealth (Underperformers)**
- #3: Sharpe=0.52, Wealth=$12, DD=12.7%
- #2, #5, #6, #9, #15: Sharpe=0.36-0.41, Wealth=$17-$20

## This Is **NORMAL** in Portfolio Theory

### Why This Makes Sense:

**Sharpe Ratio = Return / Volatility**
- Rewards **consistency**
- Penalizes **volatility** (even if it leads to gains)

**Final Wealth = Compound Growth**
- Rewards **large returns** (even if volatile)
- Doesn't care about the path taken

### The Math Behind It:

For portfolios with **tail hedge / safe haven** components:
- During normal times: Pay premium for protection → drag on returns → lower wealth accumulation
- But: Much smoother path → lower volatility → higher Sharpe
- Result: **High Sharpe, Lower Wealth**

For portfolios **without protection** or with **aggressive leverage**:
- During normal times: No hedging costs → higher returns → rapid wealth growth
- But: Volatile path with drawdowns → higher volatility → lower Sharpe  
- Result: **Lower Sharpe, Higher Wealth**

## The Question: What Do YOU Actually Want to Measure?

### Option A: Keep Current Metrics (My Recommendation)

**Sharpe Ratio IS working correctly** - it's showing you portfolios that:
- Deliver returns **efficiently** (good return per unit of risk)
- Have **smooth, consistent** performance
- Are suitable for **risk-averse** investors

**Final Wealth** shows you portfolios that:
- Deliver **absolute returns** (regardless of path)
- May be **volatile but rewarding**
- Are suitable for **risk-seeking** investors

**Both are valid!** Different investors care about different things.

### Option B: Add Complementary Metrics (Recommended Addition)

To give more complete picture, add:

**1. Sortino Ratio** - Better than Sharpe for asymmetric returns
- Only penalizes downside volatility
- Portfolios with "good volatility" (upside) get higher scores
- Formula: `(Mean Return - Target) / Downside Std Dev`

**2. Calmar Ratio** - Most intuitive
- Return per unit of max drawdown
- Formula: `Annual Return / Max Drawdown`
- Easy interpretation: "Return per % of worst loss"

**3. Omega Ratio** - Sophisticated
- Probability-weighted ratio of gains vs losses
- Accounts for entire return distribution

**4. Return/MaxDD Ratio** - Simplest
- Total return divided by max drawdown
- Very intuitive: "Bang for buck" in terms of risk

### Option C: Create Risk-Adjusted Wealth Score (Innovative)

Combine both concepts:

```python
def calculate_risk_adjusted_wealth(wealth_history):
    """Wealth adjusted for risk taken"""
    final_wealth = wealth_history[-1]
    initial_wealth = wealth_history[0]
    
    # Calculate return
    total_return = (final_wealth / initial_wealth) - 1
    
    # Risk penalty
    max_dd = calculate_max_drawdown(wealth_history) / 100
    volatility = np.std(np.diff(np.log(wealth_history)))
    
    # Adjusted wealth: penalize for risk taken
    risk_penalty = (1 + max_dd) * (1 + volatility)
    risk_adjusted_wealth = final_wealth / risk_penalty
    
    return risk_adjusted_wealth
```

This would make portfolios #1, #8, #14 (high wealth but high vol) look worse, and portfolios #4, #7, #13 (moderate wealth, low vol) look better.

## Recommendation: Multi-Dimensional View

Instead of expecting one metric to rule them all, show **THREE perspectives**:

### 1. Risk-Adjusted Return (Sharpe/Sortino)
**Question**: "Which portfolio is most EFFICIENT?"
- Best: #7, #4, #13
- Use case: Risk-averse investors, institutional mandates

### 2. Absolute Return (Final Wealth / CAGR)
**Question**: "Which portfolio makes the MOST money?"
- Best: #1, #8, #14
- Use case: Risk-seeking investors, long time horizon

### 3. Risk-Controlled Return (Calmar / Return-DD Ratio)
**Question**: "Which portfolio balances return and downside risk?"
- Likely best: #4, #13 (good on both dimensions)
- Use case: Most practical investors

## Proposed Implementation

### Add New Metrics Panel

Instead of just showing Sharpe, show a **comparison table**:

```
Portfolio | Final Wealth | Sharpe | Calmar | Return/MaxDD | Ranking
----------|--------------|--------|--------|--------------|--------
#1        | $485k        | 0.50   | 26.8   | 2613%        | Wealth Leader
#4        | $2.3k        | 0.91   | 72.3   | 689%         | Best Balanced  
#7        | $1.1k        | 1.01   | 31.9   | 328%         | Efficiency Leader
...
```

### Add Scatter Plots

1. **Sharpe vs Wealth** - Show the trade-off visually
2. **Return vs Max Drawdown** - Efficient frontier
3. **Calmar Ratio ranking** - Alternative risk-adjusted view

### Add Interpretation Guide

In visualization or docs:
```
Understanding the Metrics:
- HIGH SHARPE, MODERATE WEALTH: Consistent, steady performers
- LOW SHARPE, HIGH WEALTH: Volatile home-run hitters  
- HIGH CALMAR: Best risk/reward tradeoff
- Portfolios #4 and #13: Excel in multiple dimensions (recommended!)
```

## Bottom Line

**Your observation is correct**: There's an inverse pattern between Sharpe and Wealth.

**But this is NOT a bug**: It reflects a fundamental trade-off in portfolio construction:
- **Safe haven strategies** (#7, #4): High Sharpe, lower wealth (pay for protection)
- **Aggressive strategies** (#1, #8, #14): High wealth, lower Sharpe (volatile wins)

**Solution**: Add Calmar Ratio and Sortino Ratio to provide additional perspectives. These will help identify portfolios that achieve both good absolute returns AND controlled downside risk.

**Action Plan**:
1. Add `calculate_sortino_ratio()` function
2. Add `calculate_calmar_ratio()` function  
3. Add new visualization panel showing multi-metric comparison
4. Update documentation explaining the trade-offs
5. Highlight portfolios #4 and #13 as "best balanced" (top-5 in both metrics)



Absolutely! That's a very wise approach. Take your time to investigate the code manually, and I'll be here when you're ready to discuss what you find or move forward with any changes. For your investigation, here are the key areas to examine: Key Functions to Review:
Sharpe Ratio Calculation (line 1418):
Check the formula: (mean_return - rf_per_period) / std_return
Verify no inappropriate scaling factors
Max Drawdown Calculation (line 1392):
Formula: max((running_max - wealth) / running_max)
Confirmed mathematically correct
How strategies are simulated (around line 1239-1295):
Check if all strategies get the same market data
Verify update() calls are consistent
Return data generation:
simulate_safe_haven_returns() (line 1763)
simulate_extended_returns() (check if this exists)
Key Questions to Investigate:
Are the log returns being calculated correctly?
Is there any hidden scaling or normalization?
Do all portfolios see the same underlying returns data?
Is the wealth history being tracked correctly for each strategy?
Feel free to share any findings or questions as you investigate. I'll keep my plan ready for when you want to proceed!
